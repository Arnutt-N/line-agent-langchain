@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== Theme System ===== */
:root {
  /* Default Light Theme */
  --primary: #3b82f6;
  --primary-hover: #2563eb;
  --secondary: #10b981;
  --accent: #f59e0b;
  --surface: #ffffff;
  --surface-hover: #f9fafb;
  --background: #f3f4f6;
  --text-primary: #1f2937;
  --text-secondary: #6b7280;
  --border: #e5e7eb;
  --shadow: rgba(0, 0, 0, 0.1);
}

/* Dark Theme */
[data-theme="dark"] {
  --primary: #3b82f6;
  --primary-hover: #60a5fa;
  --secondary: #10b981;
  --accent: #f59e0b;
  --surface: #1f2937;
  --surface-hover: #374151;
  --background: #111827;
  --text-primary: #f9fafb;
  --text-secondary: #9ca3af;
  --border: #374151;
  --shadow: rgba(0, 0, 0, 0.3);
}

/* Blue Theme */
[data-theme="blue"] {
  --primary: #2563eb;
  --primary-hover: #1d4ed8;
  --secondary: #0891b2;
  --accent: #0ea5e9;
  --surface: #ffffff;
  --surface-hover: #eff6ff;
  --background: #f0f9ff;
  --text-primary: #1e3a8a;
  --text-secondary: #3b82f6;
  --border: #bfdbfe;
  --shadow: rgba(59, 130, 246, 0.1);
}

/* Green Theme */
[data-theme="green"] {
  --primary: #10b981;
  --primary-hover: #059669;
  --secondary: #14b8a6;
  --accent: #22c55e;
  --surface: #ffffff;
  --surface-hover: #f0fdf4;
  --background: #ecfdf5;
  --text-primary: #064e3b;
  --text-secondary: #047857;
  --border: #a7f3d0;
  --shadow: rgba(16, 185, 129, 0.1);
}

/* Purple Theme */
[data-theme="purple"] {
  --primary: #8b5cf6;
  --primary-hover: #7c3aed;
  --secondary: #a855f7;
  --accent: #c084fc;
  --surface: #ffffff;
  --surface-hover: #faf5ff;
  --background: #f3e8ff;
  --text-primary: #4c1d95;
  --text-secondary: #6b21a8;
  --border: #e9d5ff;
  --shadow: rgba(139, 92, 246, 0.1);
}

/* ===== Custom Components ===== */
@layer components {
  /* User Card Enhanced */
  .user-item {
    @apply flex items-center p-3 rounded-lg cursor-pointer transition-all duration-200;
    background-color: var(--surface);
    border: 1px solid var(--border);
  }
  
  .user-item:hover {
    background-color: var(--surface-hover);
    transform: translateX(4px);
    box-shadow: 0 2px 8px var(--shadow);
  }
  
  .user-item.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
  }
  
  /* Avatar Styles */
  .user-avatar {
    @apply relative w-12 h-12 rounded-full overflow-hidden mr-3 flex-shrink-0;
    background-color: var(--primary);
  }
  
  .user-avatar img {
    @apply w-full h-full object-cover;
  }
  
  .user-avatar span {
    @apply flex items-center justify-center w-full h-full text-white font-semibold;
  }
  
  /* Online Indicator */
  .online-indicator {
    @apply absolute bottom-0 right-0 w-3 h-3 rounded-full border-2;
    border-color: var(--surface);
  }
  
  .online-indicator.online {
    @apply bg-green-500;
  }
  
  .online-indicator.offline {
    @apply bg-gray-400;
  }
  
  /* Chat Mode Badge */
  .chat-mode-badge {
    @apply px-2 py-1 rounded text-xs font-medium;
  }
  
  .chat-mode-badge.bot {
    @apply bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300;
  }
  
  .chat-mode-badge.manual {
    @apply bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300;
  }
  
  /* Unread Count */
  .unread-count {
    @apply bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center;
  }
  
  /* Typing Indicator */
  .typing-indicator {
    @apply flex items-center space-x-2 p-3 rounded-lg;
    background-color: var(--surface);
  }
  
  .typing-dots {
    @apply flex space-x-1;
  }
  
  .typing-dot {
    @apply w-2 h-2 bg-gray-400 rounded-full;
    animation: typing 1.4s infinite;
  }
  
  .typing-dot:nth-child(2) {
    animation-delay: 0.2s;
  }
  
  .typing-dot:nth-child(3) {
    animation-delay: 0.4s;
  }
  
  @keyframes typing {
    0%, 60%, 100% {
      transform: translateY(0);
      opacity: 0.5;
    }
    30% {
      transform: translateY(-10px);
      opacity: 1;
    }
  }
  
  /* Message Bubbles */
  .message {
    @apply max-w-[70%] p-3 rounded-lg mb-2;
  }
  
  .message.user {
    @apply ml-auto bg-blue-500 text-white;
  }
  
  .message.admin {
    @apply mr-auto bg-green-500 text-white;
  }
  
  .message.bot {
    @apply mr-auto;
    background-color: var(--surface);
    color: var(--text-primary);
    border: 1px solid var(--border);
  }
  
  .message.system {
    @apply mx-auto text-center text-sm;
    color: var(--text-secondary);
  }
  
  /* Enhanced Buttons */
  .btn-primary {
    @apply px-4 py-2 rounded-lg font-medium transition-all duration-200;
    background-color: var(--primary);
    color: white;
  }
  
  .btn-primary:hover {
    background-color: var(--primary-hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px var(--shadow);
  }
  
  /* Stats Cards */
  .stat-card {
    @apply p-6 rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
    box-shadow: 0 1px 3px var(--shadow);
  }
  
  .stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--shadow);
  }
  
  /* Search Box Enhanced */
  .search-box {
    @apply relative;
  }
  
  .search-box input {
    @apply w-full pl-10 pr-4 py-2 rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-primary);
  }
  
  .search-box input:focus {
    @apply outline-none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
  
  .search-box i {
    @apply absolute left-3 top-1/2 transform -translate-y-1/2;
    color: var(--text-secondary);
  }
  
  /* Mobile Bottom Nav */
  @media (max-width: 768px) {
    .bottom-nav {
      @apply fixed bottom-0 left-0 right-0 flex justify-around py-2;
      background-color: var(--surface);
      border-top: 1px solid var(--border);
      box-shadow: 0 -2px 10px var(--shadow);
    }
    
    .bottom-nav button {
      @apply flex flex-col items-center p-2;
      color: var(--text-secondary);
    }
    
    .bottom-nav button.active {
      color: var(--primary);
    }
  }
  
  /* Animations */
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  .animate-slideIn {
    animation: slideIn 0.3s ease-out;
  }
  
  .animate-fadeIn {
    animation: fadeIn 0.3s ease-out;
  }
}

/* ===== Utility Classes ===== */
@layer utilities {
  /* Custom scrollbar */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-track {
    background-color: var(--background);
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: var(--text-secondary);
    border-radius: 3px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: var(--text-primary);
  }
}

/* ===== Enhanced Profile Components ===== */
@layer components {
  /* Enhanced User Item */
  .user-item {
    @apply transition-all duration-200 rounded-lg cursor-pointer;
    background-color: var(--surface);
    border: 1px solid var(--border);
  }
  
  .user-item:hover {
    background-color: var(--surface-hover);
    transform: translateX(4px);
    box-shadow: 0 2px 8px var(--shadow);
  }
  
  .user-item.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
  }
  
  .user-item.active .user-name,
  .user-item.active .user-status,
  .user-item.active .text-gray-500,
  .user-item.active .text-gray-600 {
    color: white !important;
  }
  
  /* Avatar Enhancement */
  .user-avatar {
    @apply relative flex-shrink-0;
  }
  
  .user-avatar img {
    @apply w-12 h-12 rounded-full object-cover;
  }
  
  /* Letter Avatar */
  .user-avatar > div {
    @apply w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-lg;
  }
  
  /* Status Message */
  .user-status-message {
    @apply text-xs italic opacity-75 truncate max-w-[180px];
  }
  
  /* Last Message Preview */
  .last-message-preview {
    @apply text-xs opacity-60 truncate;
  }
  
  /* Activity Time */
  .activity-time {
    @apply text-xs opacity-50;
  }
  
  /* Profile Loading State */
  .profile-loading {
    @apply animate-pulse;
  }
  
  .profile-loading .user-avatar {
    @apply bg-gray-300 rounded-full;
  }
  
  .profile-loading .user-name {
    @apply h-4 bg-gray-300 rounded w-24;
  }
  
  .profile-loading .user-status {
    @apply h-3 bg-gray-200 rounded w-16 mt-1;
  }
  
  /* Enhanced Animations */
  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
  
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }
  
  .animate-slideInRight {
    animation: slideInRight 0.3s ease-out;
  }
  
  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }
  
  /* Filter Dropdown Enhancement */
  select.filter-dropdown {
    @apply text-sm p-1.5 rounded transition-all;
    background-color: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-primary);
  }
  
  select.filter-dropdown:focus {
    @apply outline-none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
  }
  
  /* Online Count Badge */
  #online-count {
    @apply px-2 py-0.5 rounded-full text-xs;
    background-color: rgba(16, 185, 129, 0.1);
    color: rgb(16, 185, 129);
  }
  
  /* Profile Source Indicator */
  .profile-source {
    @apply absolute -top-1 -right-1 w-3 h-3 rounded-full;
  }
  
  .profile-source.api {
    @apply bg-green-500;
  }
  
  .profile-source.cache {
    @apply bg-yellow-500;
  }
  
  .profile-source.fallback {
    @apply bg-gray-400;
  }
}

/* ===== Responsive Adjustments ===== */
@media (max-width: 768px) {
  .user-item {
    @apply p-2;
  }
  
  .user-avatar img,
  .user-avatar > div {
    @apply w-10 h-10;
  }
  
  .user-name {
    @apply text-sm;
  }
  
  .user-status,
  .last-message-preview {
    @apply text-xs;
  }
  
  .chat-mode-badge {
    @apply text-xs px-1 py-0;
  }
}

/* ===== Dark Mode Specific ===== */
[data-theme="dark"] .user-item:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .user-item.active {
  background-color: var(--primary);
}

[data-theme="dark"] .profile-loading .user-avatar {
  @apply bg-gray-700;
}

[data-theme="dark"] .profile-loading .user-name {
  @apply bg-gray-700;
}

[data-theme="dark"] .profile-loading .user-status {
  @apply bg-gray-800;
}

/* ===== CRUD Operations UI ===== */
@layer components {
  /* Message Toolbar */
  .message-toolbar {
    @apply sticky top-0 z-10;
    background-color: var(--surface);
    border-bottom: 1px solid var(--border);
  }
  
  /* Message Selection */
  .message-wrapper {
    @apply relative transition-all duration-200;
  }
  
  .message-wrapper:hover {
    background-color: rgba(0, 0, 0, 0.02);
  }
  
  .message-wrapper.selected {
    background-color: rgba(59, 130, 246, 0.1);
    border-left: 3px solid var(--primary);
  }
  
  .message-checkbox {
    @apply w-4 h-4 rounded cursor-pointer;
    accent-color: var(--primary);
  }
  
  /* Message Actions */
  .message-actions {
    @apply absolute top-2 right-2 flex gap-1;
  }
  
  .btn-icon-sm {
    @apply p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-all;
  }
  
  /* Search Container */
  .message-search-container {
    background-color: var(--surface);
    border-bottom: 1px solid var(--border);
  }
  
  /* Bulk Actions Menu */
  .bulk-actions-menu {
    @apply fixed z-50;
  }
  
  .bulk-action-item {
    @apply w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center;
  }
  
  .bulk-action-item:hover {
    background-color: var(--surface-hover);
  }
  
  /* Export Dialog */
  .dialog-overlay {
    @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50;
  }
  
  .dialog-content {
    @apply bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl max-w-md w-full;
  }
  
  /* Notifications */
  .notification {
    @apply fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 min-w-[300px];
    background-color: var(--surface);
    border: 1px solid var(--border);
  }
  
  .notification-success {
    @apply border-green-500;
    background-color: rgba(16, 185, 129, 0.1);
  }
  
  .notification-error {
    @apply border-red-500;
    background-color: rgba(239, 68, 68, 0.1);
  }
  
  .notification-info {
    @apply border-blue-500;
    background-color: rgba(59, 130, 246, 0.1);
  }
  
  /* Loading Spinner */
  .spinner {
    @apply inline-block w-8 h-8 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin;
  }
  
  /* Enhanced Buttons */
  .btn-icon {
    @apply p-2 rounded-lg transition-all hover:bg-gray-100 dark:hover:bg-gray-700;
  }
  
  .btn-secondary {
    @apply px-3 py-1.5 text-sm font-medium rounded-lg transition-all;
    background-color: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-primary);
  }
  
  .btn-secondary:hover {
    background-color: var(--surface-hover);
  }
  
  .btn-danger {
    @apply px-3 py-1.5 text-sm font-medium rounded-lg transition-all;
    background-color: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: rgb(239, 68, 68);
  }
  
  .btn-danger:hover {
    background-color: rgba(239, 68, 68, 0.2);
  }
  
  .btn-danger:disabled {
    @apply opacity-50 cursor-not-allowed;
  }
  
  /* Message Status Indicators */
  .message-wrapper.unread {
    font-weight: 600;
  }
  
  .message-wrapper.unread::before {
    content: '';
    @apply absolute left-0 top-0 bottom-0 w-1 bg-blue-500;
  }
  
  /* Message Edit Indicator */
  .message.edited::after {
    content: '(edited)';
    @apply text-xs text-gray-400 ml-1;
  }
  
  /* Pagination */
  .pagination {
    @apply flex items-center justify-center gap-2 mt-4;
  }
  
  .pagination-btn {
    @apply px-3 py-1 rounded border transition-all;
    background-color: var(--surface);
    border-color: var(--border);
  }
  
  .pagination-btn:hover:not(:disabled) {
    background-color: var(--surface-hover);
  }
  
  .pagination-btn.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
  }
  
  .pagination-btn:disabled {
    @apply opacity-50 cursor-not-allowed;
  }
}

/* ===== Animations for CRUD ===== */
@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.animate-slideDown {
  animation: slideDown 0.3s ease-out;
}

.animate-fadeOut {
  animation: fadeOut 0.3s ease-out;
}

/* ===== Mobile Adjustments for CRUD ===== */
@media (max-width: 768px) {
  .message-toolbar {
    @apply flex-col gap-2 p-2;
  }
  
  .message-search-container {
    @apply p-2;
  }
  
  .message-search-container .flex {
    @apply flex-col gap-2;
  }
  
  .notification {
    @apply right-2 left-2 min-w-0;
  }
  
  .dialog-content {
    @apply mx-4;
  }
  
  .message-actions {
    @apply opacity-100;
  }
}

/* ===== Dark Mode Adjustments ===== */
[data-theme="dark"] .btn-secondary {
  background-color: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .btn-secondary:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .spinner {
  border-color: rgba(255, 255, 255, 0.2);
  border-top-color: var(--primary);
}

/* ===== Analytics Dashboard Styles ===== */
@layer components {
  /* Dashboard Container */
  .analytics-dashboard {
    @apply p-6;
    background-color: var(--background);
    min-height: 100vh;
  }

  /* KPI Cards */
  .kpi-card {
    @apply p-6 rounded-lg transition-all duration-200;
    background-color: var(--surface);
    border: 1px solid var(--border);
    box-shadow: 0 1px 3px var(--shadow);
  }

  .kpi-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--shadow);
  }

  .kpi-header {
    @apply flex items-center justify-between mb-3;
  }

  .kpi-value {
    @apply mb-2;
  }

  .kpi-trend {
    @apply flex items-center gap-2 text-sm;
  }

  /* Charts */
  .chart-container {
    @apply p-6 rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
    box-shadow: 0 1px 3px var(--shadow);
    height: 400px;
  }

  .chart-title {
    @apply text-lg font-semibold mb-4;
    color: var(--text-primary);
  }

  .chart-container canvas {
    max-height: 320px;
  }

  /* Tables */
  .table-container {
    @apply p-6 rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
    box-shadow: 0 1px 3px var(--shadow);
  }

  .table-title {
    @apply text-lg font-semibold mb-4;
    color: var(--text-primary);
  }

  .analytics-table {
    @apply w-full;
  }

  .analytics-table thead {
    @apply border-b;
    border-color: var(--border);
  }

  .analytics-table th {
    @apply px-4 py-3 text-left text-sm font-medium;
    color: var(--text-secondary);
  }

  .analytics-table td {
    @apply px-4 py-3 text-sm;
    color: var(--text-primary);
  }

  .analytics-table tbody tr {
    @apply border-b transition-colors;
    border-color: var(--border);
  }

  .analytics-table tbody tr:hover {
    background-color: var(--surface-hover);
  }

  /* Activity Log */
  .activity-log {
    @apply space-y-3 max-h-96 overflow-y-auto custom-scrollbar;
  }

  .activity-item {
    @apply flex items-start gap-3 p-3 rounded-lg transition-all;
    background-color: var(--background);
  }

  .activity-item:hover {
    background-color: var(--surface-hover);
  }

  .activity-icon {
    @apply w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0;
  }

  .activity-icon.message {
    @apply bg-blue-100 text-blue-600;
  }

  .activity-icon.bot {
    @apply bg-green-100 text-green-600;
  }

  .activity-icon.admin {
    @apply bg-orange-100 text-orange-600;
  }

  .activity-icon.user {
    @apply bg-purple-100 text-purple-600;
  }

  .activity-content {
    @apply flex-1;
  }

  .activity-text {
    @apply text-sm;
    color: var(--text-primary);
  }

  .activity-time {
    @apply text-xs;
    color: var(--text-secondary);
  }

  /* Status Badge */
  .status-badge {
    @apply px-2 py-1 rounded-full text-xs font-medium;
  }

  .status-badge.active {
    @apply bg-green-100 text-green-700;
  }

  .status-badge.inactive {
    @apply bg-gray-100 text-gray-700;
  }

  /* Date Range Picker */
  .date-range-picker {
    @apply flex items-center;
  }

  .date-range-picker select,
  .date-range-picker input[type="date"] {
    @apply px-3 py-2 rounded-lg border transition-all;
    background-color: var(--surface);
    border-color: var(--border);
    color: var(--text-primary);
  }

  .date-range-picker select:focus,
  .date-range-picker input[type="date"]:focus {
    @apply outline-none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  /* Skeleton Loader */
  .skeleton-loader {
    @apply animate-pulse bg-gray-300 dark:bg-gray-700 rounded;
  }

  /* Responsive Grid */
  @media (max-width: 1024px) {
    .analytics-dashboard .grid {
      @apply grid-cols-1;
    }

    .chart-container {
      height: 300px;
    }

    .chart-container canvas {
      max-height: 240px;
    }
  }

  @media (max-width: 768px) {
    .analytics-header .flex {
      @apply flex-col gap-3;
    }

    .date-range-picker {
      @apply flex-col gap-2 w-full;
    }

    .kpi-card {
      @apply p-4;
    }

    .chart-container,
    .table-container {
      @apply p-4;
    }
  }
}

/* ===== Dark Mode Specific ===== */
[data-theme="dark"] .activity-icon.message {
  @apply bg-blue-900 text-blue-300;
}

[data-theme="dark"] .activity-icon.bot {
  @apply bg-green-900 text-green-300;
}

[data-theme="dark"] .activity-icon.admin {
  @apply bg-orange-900 text-orange-300;
}

[data-theme="dark"] .activity-icon.user {
  @apply bg-purple-900 text-purple-300;
}

[data-theme="dark"] .status-badge.active {
  @apply bg-green-900 text-green-300;
}

[data-theme="dark"] .status-badge.inactive {
  @apply bg-gray-800 text-gray-400;
}

/* ===== Chart.js Theme Integration ===== */
.chart-container {
  position: relative;
}

/* Ensure charts are responsive */
.chart-container canvas {
  width: 100% !important;
  height: auto !important;
  max-height: 320px;
}

/* Custom tooltip styling */
#chartjs-tooltip {
  @apply p-3 rounded-lg shadow-lg;
  background-color: var(--surface);
  border: 1px solid var(--border);
  color: var(--text-primary);
  font-size: 0.875rem;
}

/* ===== Analytics Animations ===== */
@keyframes countUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.kpi-value span {
  animation: countUp 0.5s ease-out;
}

/* Trend animations */
.kpi-trend {
  animation: fadeIn 0.5s ease-out 0.3s both;
}

/* Chart animations */
.chart-container {
  animation: fadeIn 0.5s ease-out 0.2s both;
}

/* Table row animations */
.analytics-table tbody tr {
  animation: slideIn 0.3s ease-out;
}

/* Activity item animations */
.activity-item {
  animation: slideInRight 0.3s ease-out;
}

/* ===== Chat History Management Styles ===== */
@layer components {
  /* Container */
  .history-management-container {
    @apply h-full flex flex-col;
    background-color: var(--background);
  }

  .history-header {
    @apply flex items-center justify-between p-6 border-b;
    background-color: var(--surface);
    border-color: var(--border);
  }

  .history-controls {
    @apply p-4 space-y-4;
    background-color: var(--surface);
    border-bottom: 1px solid var(--border);
  }

  /* Search Bar */
  .history-search-bar {
    @apply relative;
  }

  .search-input-group {
    @apply flex items-center;
  }

  .search-icon {
    @apply absolute left-3 w-5 h-5;
    color: var(--text-secondary);
  }

  .history-search-input {
    @apply w-full pl-10 pr-12 py-3 rounded-lg;
    background-color: var(--background);
    border: 1px solid var(--border);
    color: var(--text-primary);
  }

  .history-search-input:focus {
    @apply outline-none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  /* Advanced Search Panel */
  .advanced-search-panel {
    @apply mt-4 p-4 rounded-lg;
    background-color: var(--background);
    border: 1px solid var(--border);
  }

  .search-filters {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4;
  }

  .filter-group {
    @apply space-y-2;
  }

  .filter-group label {
    @apply block text-sm font-medium;
    color: var(--text-secondary);
  }

  .filter-select,
  .filter-input {
    @apply w-full px-3 py-2 rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-primary);
  }

  .search-actions {
    @apply flex gap-2 justify-end;
  }

  /* Stats Bar */
  .history-stats-bar {
    @apply flex flex-wrap gap-4 px-4 py-2;
    background-color: var(--background);
  }

  .stat-item {
    @apply flex items-center gap-2;
  }

  .stat-label {
    @apply text-sm;
    color: var(--text-secondary);
  }

  .stat-value {
    @apply text-sm font-semibold;
    color: var(--text-primary);
  }

  /* Content Area */
  .history-content {
    @apply flex-1 flex gap-4 p-4 overflow-hidden;
  }

  /* Conversations Panel */
  .conversations-panel {
    @apply w-full lg:w-1/3 flex flex-col rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
  }

  .panel-header {
    @apply flex items-center justify-between p-4 border-b;
    border-color: var(--border);
  }

  .panel-title {
    @apply font-semibold;
    color: var(--text-primary);
  }

  .panel-actions {
    @apply flex gap-2;
  }

  .conversations-list {
    @apply flex-1 overflow-y-auto custom-scrollbar p-4 space-y-3;
  }

  /* Conversation Card */
  .conversation-card {
    @apply p-4 rounded-lg cursor-pointer transition-all;
    background-color: var(--background);
    border: 1px solid var(--border);
  }

  .conversation-card:hover {
    background-color: var(--surface-hover);
    transform: translateX(2px);
    box-shadow: 0 2px 8px var(--shadow);
  }

  .conversation-card.selected {
    border-color: var(--primary);
    background-color: rgba(59, 130, 246, 0.05);
  }

  .conversation-header {
    @apply flex items-center gap-3 mb-2;
  }

  .user-avatar {
    @apply w-10 h-10 rounded-full object-cover;
  }

  .conversation-info {
    @apply flex-1;
  }

  .conversation-title {
    @apply font-medium;
    color: var(--text-primary);
  }

  .conversation-meta {
    @apply text-xs;
    color: var(--text-secondary);
  }

  .conversation-status {
    @apply px-2 py-1 rounded-full text-xs font-medium;
  }

  .conversation-status.status-resolved {
    @apply bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300;
  }

  .conversation-status.status-active {
    @apply bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300;
  }

  .conversation-preview {
    @apply text-sm truncate;
    color: var(--text-secondary);
  }

  /* Detail Panel */
  .conversation-detail-panel {
    @apply flex-1 flex flex-col rounded-lg;
    background-color: var(--surface);
    border: 1px solid var(--border);
  }

  .conversation-placeholder {
    @apply flex-1 flex flex-col items-center justify-center;
    color: var(--text-secondary);
  }

  .conversation-detail {
    @apply flex-1 flex flex-col;
  }

  .detail-header {
    @apply flex items-center justify-between p-4 border-b;
    border-color: var(--border);
  }

  .user-info {
    @apply flex items-center gap-3;
  }

  .user-name {
    @apply font-semibold;
    color: var(--text-primary);
  }

  .session-info {
    @apply text-sm;
    color: var(--text-secondary);
  }

  .detail-actions {
    @apply flex gap-2;
  }

  /* Messages */
  .detail-messages {
    @apply flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar;
  }

  .history-message {
    @apply p-3 rounded-lg;
  }

  .history-message.user {
    @apply ml-auto max-w-[70%];
    background-color: var(--primary);
    color: white;
  }

  .history-message.bot {
    @apply mr-auto max-w-[70%];
    background-color: var(--background);
    border: 1px solid var(--border);
  }

  .history-message.admin {
    @apply mr-auto max-w-[70%];
    background-color: rgba(251, 146, 60, 0.1);
    border: 1px solid rgba(251, 146, 60, 0.3);
  }

  .message-header {
    @apply flex items-center justify-between mb-1;
  }

  .message-sender {
    @apply text-xs font-medium;
  }

  .message-time {
    @apply text-xs opacity-70;
  }

  .message-content {
    @apply text-sm;
  }

  /* Analytics */
  .conversation-analytics {
    @apply p-4 border-t;
    border-color: var(--border);
  }

  .analytics-title {
    @apply font-semibold mb-4;
    color: var(--text-primary);
  }

  .analytics-grid {
    @apply grid grid-cols-1 md:grid-cols-2 gap-4;
  }

  .analytics-card {
    @apply p-4 rounded-lg;
    background-color: var(--background);
    border: 1px solid var(--border);
  }

  .analytics-card h5 {
    @apply font-medium mb-3;
    color: var(--text-primary);
  }

  .metric {
    @apply flex items-center justify-between py-1;
  }

  .metric-label {
    @apply text-sm;
    color: var(--text-secondary);
  }

  .metric-value {
    @apply text-sm font-semibold;
    color: var(--text-primary);
  }

  /* Flow Diagram */
  .flow-diagram {
    @apply flex items-center flex-wrap gap-2;
  }

  .flow-step {
    @apply flex items-center gap-2;
  }

  .step-number {
    @apply w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium;
    background-color: var(--primary);
    color: white;
  }

  .step-label {
    @apply text-sm;
    color: var(--text-primary);
  }

  .flow-arrow {
    @apply text-sm;
    color: var(--text-secondary);
  }

  /* Topics Cloud */
  .topics-cloud {
    @apply flex flex-wrap gap-2;
  }

  .topic-tag {
    @apply px-3 py-1 rounded-full text-xs font-medium;
    background-color: var(--background);
    color: var(--text-primary);
    border: 1px solid var(--border);
  }

  /* States */
  .loading-placeholder,
  .empty-state,
  .error-state {
    @apply flex flex-col items-center justify-center py-8;
    color: var(--text-secondary);
  }

  .loading {
    @apply text-center py-4;
    color: var(--text-secondary);
  }

  .error {
    @apply text-center py-4 text-red-600;
  }

  /* Mobile Responsive */
  @media (max-width: 1024px) {
    .history-content {
      @apply flex-col;
    }

    .conversations-panel {
      @apply w-full h-1/3;
    }

    .conversation-detail-panel {
      @apply h-2/3;
    }
  }

  @media (max-width: 640px) {
    .search-filters {
      @apply grid-cols-1;
    }

    .history-stats-bar {
      @apply flex-col;
    }

    .conversation-card {
      @apply p-3;
    }
  }
}

/* ===== Dark Mode Adjustments ===== */
[data-theme="dark"] .conversation-card {
  background-color: rgba(255, 255, 255, 0.02);
}

[data-theme="dark"] .conversation-card:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .conversation-status.status-resolved {
  @apply bg-green-900 text-green-300;
}

[data-theme="dark"] .conversation-status.status-active {
  @apply bg-blue-900 text-blue-300;
}

[data-theme="dark"] .history-message.bot {
  background-color: rgba(255, 255, 255, 0.05);
}
